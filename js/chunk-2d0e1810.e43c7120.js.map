{"version":3,"sources":["webpack:///./src/views/week3/ex3.vue?9ae8","webpack:///./src/scripts/week3/ex3.ts","webpack:///./src/views/week3/ex3.vue","webpack:///./src/views/week3/ex3.vue?bdc3","webpack:///./src/views/week3/ex3.vue?317c"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","attrs","calculate","test","staticRenderFns","mainEx3","input","tokens","utils","ans","calculateBracketedFormula","testEx3","result","eq","includes","count","beginIdx","indexOf","idx","length","partialTokens","slice","unshift","partialAns","newTokens","isNaN","push","backPartialTokens","concat","name","components","ExComponent","component"],"mappings":"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","file":"js/chunk-2d0e1810.e43c7120.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h2',[_vm._v(\"Week3\")]),_c('ex-component',{attrs:{\"title\":\"宿題3\",\"valid-input-explanation\":\"半角数字(小数含む)と+-*/()が入力可能。()前後の*は省略可能\",\"calculate\":_vm.calculate,\"test\":_vm.test}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Token } from './type'\nimport * as utils from './utils'\nimport { calculate } from './ex1'\nimport { Big } from 'big.js'\n\nexport const mainEx3 = (input: string) => {\n  const tokens = utils.tokenize(input, ['+', '-', '*', '/', '(', ')'])\n  if (tokens === null) return 'error'\n  const ans = calculateBracketedFormula(tokens)\n  return ans\n}\n\nexport const testEx3 = () => {\n  let ans = 2\n  let result = mainEx3('(1+1)')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 2\n  result = mainEx3('2*(1+1)/2')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 1.4\n  result = mainEx3('(3+4*(2-1))/5')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 18\n  result = mainEx3('((1+1)+1)*(3+3)')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 5\n  result = mainEx3('1+(1+(1+1))+1')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 11.1\n  result = mainEx3('(1.5+2.2)*3')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = -11.1\n  result = mainEx3('(1.5+2.2)*(-3)')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 16\n  result = mainEx3('2(3+5)')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = 16\n  result = mainEx3('2(3-1+2)2')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  ans = -0.2\n  result = mainEx3('1+(-(0.1+1.1))')\n  if (result === 'error' || !result.eq(ans)) return 'NG'\n\n  result = mainEx3('1+(2+3')\n  if (result !== 'error') return 'NG'\n\n  result = mainEx3('1)+2+3')\n  if (result !== 'error') return 'NG'\n\n  result = mainEx3('(((3))')\n  if (result !== 'error') return 'NG'\n\n  result = mainEx3('()*2+1')\n  if (result !== 'error') return 'NG'\n\n  result = mainEx3('(1+1*)2')\n  if (result !== 'error') return 'NG'\n\n  return 'OK'\n}\n\n/** () を含む数式を計算 */\nconst calculateBracketedFormula = (tokens: Token[]): Big | 'error' => {\n  // かっこが対になっていなかったらエラー\n  if (tokens.includes('(') && !tokens.includes(')')) return 'error'\n  if (!tokens.includes('(') && tokens.includes(')')) return 'error'\n\n  if (tokens.includes('(')) {\n    let count = 0\n    const beginIdx = tokens.indexOf('(')\n    let idx = beginIdx + 1\n    // 対になるかっこを探す\n    while ((count !== 0 || tokens[idx] !== ')') && idx < tokens.length) {\n      if (tokens[idx] === '(') count += 1\n      if (tokens[idx] === ')') count -= 1\n      idx += 1\n    }\n\n    // ( と ) の数が合わなかったらエラー\n    if (idx >= tokens.length) return 'error'\n\n    // () の内側を計算済みのものに置き換えて数式を再構築し、再度計算\n    const partialTokens = tokens.slice(beginIdx + 1, idx)\n    if (partialTokens.length === 0) return 'error' // () の内側が空だったらエラー\n    if (partialTokens[0] !== '-') partialTokens.unshift('+') // ダミーの + を挿入\n    const partialAns = calculateBracketedFormula(partialTokens)\n    if (partialAns === 'error') return 'error'\n\n    let newTokens = tokens.slice(0, beginIdx)\n    if (newTokens.length > 0 && !isNaN(+newTokens[newTokens.length - 1]))\n      newTokens.push('*') // * が省略されていたら挿入\n    newTokens.push(partialAns)\n\n    const backPartialTokens = tokens.slice(idx + 1)\n    if (backPartialTokens.length > 0 && !isNaN(+backPartialTokens[0]))\n      backPartialTokens.unshift('*') // * が省略されていたら挿入\n    newTokens = newTokens.concat(backPartialTokens)\n\n    return calculateBracketedFormula(newTokens)\n  }\n  // () が無ければ普通に計算\n  return calculate(tokens)\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Component } from 'vue-property-decorator'\nimport ExComponent from '@/components/week3/ex-component.vue'\nimport { mainEx3, testEx3 } from '@/scripts/week3/ex3'\n\n@Component({\n  name: 'Week3Ex3',\n  components: {\n    ExComponent,\n  },\n})\nexport default class extends Vue {\n  calculate = mainEx3\n  test = testEx3\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--13-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ex3.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--13-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ex3.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ex3.vue?vue&type=template&id=582d9a6c&\"\nimport script from \"./ex3.vue?vue&type=script&lang=ts&\"\nexport * from \"./ex3.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}